function load(){var t=$(".canva").width();400<$(window).width()&&(t=400);var n=$(".can")[0],d=n.getContext("2d");n.width=t,n.height=t,d.translate(t/2,t/2);for(var o=[],a=function(t,n){return Math.floor(Math.random()*(n-t+1)+t)},i=0,e=0;e<9;e++){var l=a(100,500);i+=l,o.push({name:"电影"+e,color:"rgb("+a(0,255)+","+a(0,255)+","+a(0,255)+")",num:l})}o.sort(function(t,n){return n.num-t.num}).map(function(t,n){var o=(t.num/i*100).toFixed(2),a=t.num/i*360;t.bili=o,t.jiaodu=a});var u=Math.PI/180,c=-90,h=t/2-50;o.map(function(t,n){var o,a,i=c+t.jiaodu,e=(c+t.jiaodu/2)*u,l=Math.cos(e)*h,r=Math.sin(e)*h;d.beginPath(),d.moveTo(0,0),d.arc(0,0,h,c*u,i*u),d.fillStyle=t.color,d.fill(),c=i,d.closePath(),d.strokeStyle=t.color,n<5&&function(t,n){d.beginPath(),d.moveTo(t,n),0<t&&n<0?(d.lineTo(t+10,n-10),d.lineTo(t+70,n-10)):0<t&&0<n?(d.lineTo(t+10,n+10),d.lineTo(t+70,n+10)):t<0&&0<n?(d.lineTo(t-10,n+10),d.lineTo(t-70,n+10)):t<0&&n<0&&(d.lineTo(t-10,n-10),d.lineTo(t-70,n-10));d.stroke()}(l,r),a='<tr align="center"<td><span style="background:'+(o=t).color+';"></span>'+o.name+"</td><td>"+o.bili+"</td><td>"+o.num+"</td><td>"+o.num+"</td></tr>",$(".table>tbody").append(a)}),d.beginPath(),d.arc(0,0,t/2-110,0,360*u),d.fillStyle="#fff",d.strokeStyle="rgba(255,255,255,.5)",d.lineWidth=20,d.stroke(),d.fill()}load(),$(window).on("resize",load);